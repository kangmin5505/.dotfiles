# ==============================================================================
# TMUX CONFIGURATION (Prefix = Ctrl + a)
# ==============================================================================

# --- General Settings ---
set -sa terminal-overrides ",xterm*:Tc"
set -g default-terminal "screen-256color"
set -g base-index 1              # Start window index at 1
set -g pane-base-index 1         # Start pane index at 1
set -g history-limit 100000      # Increase scrollback buffer size
set -g mouse on                  # Enable mouse support
set -sg escape-time 0            # Remove delay for ESC key press
set -g status-keys vi            # Use vi keys in command prompt
set -g display-time 3000         # Increase display time for messages

# --- Prefix Key ---
unbind C-b                       # Unbind default prefix
set -g prefix C-a                # Set prefix to Ctrl+a
bind C-a send-prefix

# --- Display & Activity ---
setw -g monitor-activity on      # Highlight windows with background activity
set -g visual-activity off

# --- Key Bindings: Core ---
# Reload configuration file
bind r source-file ~/.config/tmux/tmux.conf \; display-message "tmux.conf reloaded."

# Synchronize panes (send keystrokes to all panes simultaneously)
bind Y set-window-option synchronize-panes \; display-message "Synchronize mode toggled."

# --- Key Bindings: Window & Pane Management ---
# Split panes using | and -, retaining current directory path
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Resize panes using Prefix + HJKL
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Switch windows using Alt + number without prefix
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# --- Copy Mode (Vi) ---
setw -g mode-keys vi
unbind p
bind p paste-buffer
bind -T copy-mode-vi 'v' send -X begin-selection
bind -T copy-mode-vi 'y' send -X copy-selection-and-cancel


# ==============================================================================
# --- Plugins & Keybindings ---
# ==============================================================================

# 1. TPM (Tmux Plugin Manager)
# [Keys] Prefix + I (Install) / Prefix + U (Update) / Prefix + Alt + u (Uninstall)
set -g @plugin 'tmux-plugins/tpm'

# 2. Tmux Sensible (Basic sensible settings - No specific bindings)
set -g @plugin 'tmux-plugins/tmux-sensible'

# 3. Tmux Themepack (Status bar theme - No specific bindings)
set -g @plugin 'jimeh/tmux-themepack'
set -g @themepack 'powerline/block/gray'

# 4. Vim-Tmux-Navigator (Seamless navigation between Neovim splits and Tmux panes)
# [Keys] Ctrl + h, j, k, l (Navigate Left, Down, Up, Right)
set -g @plugin 'christoomey/vim-tmux-navigator'

# 5. Tmux Sessionist (Lightweight utility for managing sessions)
# [Keys] Prefix + Shift + c (Prompt to create a new session)
# [Keys] Prefix + Shift + x (Kill current session and switch to another)
# [Keys] Prefix + g (Prompt to switch session by name)
set -g @plugin 'tmux-plugins/tmux-sessionist'

# 6. Tmux Resurrect & Continuum (Save and restore tmux environments)
# [Keys] Prefix + Ctrl + s (Save current state)
# [Keys] Prefix + Ctrl + r (Restore saved state)
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on' # Automatically restore tmux sessions on start

# 7. Tmux SessionX (Visual session manager built on top of fzf - The Ultimate tool)
# [Keys] Prefix + o (Open fzf popup -> search session -> Enter to jump)
set -g @plugin 'omerxx/tmux-sessionx'

# 8. Tmux Yank (Copy to OS system clipboard)
# [Keys] Prefix + [ (Enter copy mode) -> v (Start selection) -> y (Copy to OS clipboard)
set -g @plugin 'tmux-plugins/tmux-yank'

# 9. Tmux Menus (Interactive popup menus for tmux commands when you forget shortcuts)
# [Keys] Prefix + \ (Open popup menu) 
set -g @plugin 'jaclu/tmux-menus'

# 10. Tmux Fuzzback (Search scrollback buffer history using fzf)
# [Keys] Prefix + ? (Open fzf popup -> search logs/errors -> Enter to jump)
set -g @plugin 'roosta/tmux-fuzzback'

# Initialize TMUX plugin manager (Keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
